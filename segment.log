[2022-02-17 14:12:43,886][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-02-17 14:12:44,069][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-02-17 14:12:44,069][prefect.TaskRunner][WARNING] - Task 'get_pca_model': Can't use cache because it is now invalid
[2022-02-17 14:12:44,291][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Cached'
[2022-02-17 14:12:44,409][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-02-17 14:12:44,410][prefect.TaskRunner][WARNING] - Task 'reduce_dimension': Can't use cache because it is now invalid
[2022-02-17 14:12:44,510][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Cached'
[2022-02-17 14:12:44,594][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-02-17 14:12:44,649][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-02-17 14:12:44,755][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-02-17 14:12:44,756][prefect.TaskRunner][WARNING] - Task 'get_best_k_cluster': Can't use cache because it is now invalid
[2022-02-17 14:13:05,629][matplotlib.axes._base][INFO] - <class 'matplotlib.axis.YAxis'>
[2022-02-17 14:13:06,295][prefect.TaskRunner][ERROR] - Task 'get_best_k_cluster': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/.cache/pypoetry/virtualenvs/customer-segmentation-LPbbNRXa-py3.8/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/.cache/pypoetry/virtualenvs/customer-segmentation-LPbbNRXa-py3.8/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 65, in get_best_k_cluster
    wandb.log(
  File "/home/khuyen/.cache/pypoetry/virtualenvs/customer-segmentation-LPbbNRXa-py3.8/lib/python3.8/site-packages/wandb/sdk/lib/preinit.py", line 38, in preinit_wrapper
    raise wandb.Error("You must call wandb.init() before {}()".format(name))
wandb.errors.Error: You must call wandb.init() before wandb.log()
[2022-02-17 14:13:06,333][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Failed'
[2022-02-17 14:13:06,398][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-02-17 14:13:06,429][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'TriggerFailed'
[2022-02-17 14:13:06,527][prefect.TaskRunner][INFO] - Task 'save_model': Starting task run...
[2022-02-17 14:13:06,558][prefect.TaskRunner][INFO] - Task 'save_model': Finished task run for task with final state: 'TriggerFailed'
[2022-02-17 14:13:06,626][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-02-17 14:13:06,678][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-02-17 14:13:06,856][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-02-17 14:13:06,887][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-02-17 14:13:06,953][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-02-17 14:13:06,985][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-02-17 14:13:06,989][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-02-17 14:14:18,123][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-02-17 14:14:18,282][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-02-17 14:14:18,283][prefect.TaskRunner][WARNING] - Task 'get_pca_model': Can't use cache because it is now invalid
[2022-02-17 14:14:18,522][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Cached'
[2022-02-17 14:14:18,635][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-02-17 14:14:18,636][prefect.TaskRunner][WARNING] - Task 'reduce_dimension': Can't use cache because it is now invalid
[2022-02-17 14:14:18,734][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Cached'
[2022-02-17 14:14:18,800][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-02-17 14:14:18,835][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:18,915][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-02-17 14:14:18,916][prefect.TaskRunner][WARNING] - Task 'get_best_k_cluster': Can't use cache because it is now invalid
[2022-02-17 14:14:36,505][matplotlib.axes._base][INFO] - <class 'matplotlib.axis.YAxis'>
[2022-02-17 14:14:37,151][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Cached'
[2022-02-17 14:14:37,215][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-02-17 14:14:39,179][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:39,251][prefect.TaskRunner][INFO] - Task 'save_model': Starting task run...
[2022-02-17 14:14:39,386][prefect.TaskRunner][INFO] - Task 'save_model': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:39,457][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-02-17 14:14:39,765][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:39,882][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-02-17 14:14:40,021][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:40,086][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-02-17 14:14:41,190][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-02-17 14:14:41,196][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-02-17 15:10:11,426][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-02-17 15:10:11,568][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-02-17 15:10:11,569][prefect.TaskRunner][WARNING] - Task 'get_pca_model': Can't use cache because it is now invalid
[2022-02-17 15:10:11,823][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Cached'
[2022-02-17 15:10:11,932][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-02-17 15:10:11,933][prefect.TaskRunner][WARNING] - Task 'reduce_dimension': Can't use cache because it is now invalid
[2022-02-17 15:10:12,038][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Cached'
[2022-02-17 15:10:12,104][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-02-17 15:10:12,140][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:12,209][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-02-17 15:10:12,210][prefect.TaskRunner][WARNING] - Task 'get_best_k_cluster': Can't use cache because it is now invalid
[2022-02-17 15:10:27,528][matplotlib.axes._base][INFO] - <class 'matplotlib.axis.YAxis'>
[2022-02-17 15:10:28,176][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Cached'
[2022-02-17 15:10:28,239][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-02-17 15:10:29,918][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:29,992][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-02-17 15:10:30,374][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:30,494][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-02-17 15:10:30,645][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:30,709][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-02-17 15:10:31,802][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:31,865][prefect.TaskRunner][INFO] - Task 'save_model': Starting task run...
[2022-02-17 15:10:32,004][prefect.TaskRunner][INFO] - Task 'save_model': Finished task run for task with final state: 'Success'
[2022-02-17 15:10:32,009][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-02-17 17:03:26,066][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-02-17 17:03:26,179][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-02-17 17:03:26,464][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:26,576][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-02-17 17:03:26,659][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:26,776][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-02-17 17:03:26,873][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:26,942][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-02-17 17:03:26,977][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:27,044][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-02-17 17:03:43,671][matplotlib.axes._base][INFO] - <class 'matplotlib.axis.YAxis'>
[2022-02-17 17:03:44,317][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:44,379][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-02-17 17:03:46,107][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:46,171][prefect.TaskRunner][INFO] - Task 'save_model': Starting task run...
[2022-02-17 17:03:46,312][prefect.TaskRunner][INFO] - Task 'save_model': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:46,379][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-02-17 17:03:46,710][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:46,823][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-02-17 17:03:46,965][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:47,029][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-02-17 17:03:48,145][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-02-17 17:03:48,149][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
