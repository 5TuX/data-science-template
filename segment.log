[2022-03-10 15:07:50,103][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:07:50,238][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:07:50,466][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:07:50,539][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:07:50,540][prefect.TaskRunner][ERROR] - Task 'wandb_log': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 126, in wandb_log
    models = config.models
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 357, in __getattr__
    self._format_and_raise(key=key, value=None, cause=e)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 741, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 351, in __getattr__
    return self._get_impl(key=key, default_value=_DEFAULT_MARKER_)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 438, in _get_impl
    node = self._get_node(key=key, throw_on_missing_key=True)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 465, in _get_node
    self._validate_get(key)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 166, in _validate_get
    self._format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 821, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
omegaconf.errors.ConfigAttributeError: Key 'models' is not in struct
    full_key: models
    object_type=dict
[2022-03-10 15:07:50,578][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Failed'
[2022-03-10 15:07:50,639][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:07:50,764][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:07:50,871][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:07:50,908][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:07:50,971][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:07:59,256][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:07:59,318][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:07:59,352][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:07:59,421][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-03-10 15:08:00,892][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:08:00,964][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:08:01,199][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:08:01,309][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:08:01,435][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:08:01,499][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:08:02,421][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:08:02,426][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:11:48,468][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:11:48,570][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:11:48,834][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:11:48,954][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:11:49,033][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:11:49,129][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:11:49,141][prefect.TaskRunner][ERROR] - Task 'wandb_log': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 131, in wandb_log
    wandb.log({"num_cols": len(config.process.keep_columns)})
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 357, in __getattr__
    self._format_and_raise(key=key, value=None, cause=e)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 741, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 351, in __getattr__
    return self._get_impl(key=key, default_value=_DEFAULT_MARKER_)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 438, in _get_impl
    node = self._get_node(key=key, throw_on_missing_key=True)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 465, in _get_node
    self._validate_get(key)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 166, in _validate_get
    self._format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 821, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
omegaconf.errors.ConfigAttributeError: Key 'keep_columns' is not in struct
    full_key: process.keep_columns
    object_type=dict
[2022-03-10 15:11:49,183][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Failed'
[2022-03-10 15:11:49,301][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:11:49,343][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:11:49,412][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:11:49,446][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:11:49,510][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:14:25,206][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:14:25,301][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:14:25,302][prefect.TaskRunner][ERROR] - Task 'wandb_log': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 126, in wandb_log
    wandb.log_artifact(config.raw_data.path, name='raw_data', type='data')
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/wandb/sdk/lib/preinit.py", line 38, in preinit_wrapper
    raise wandb.Error("You must call wandb.init() before {}()".format(name))
wandb.errors.Error: You must call wandb.init() before wandb.log_artifact()
[2022-03-10 15:14:25,472][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Failed'
[2022-03-10 15:14:25,562][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:14:25,720][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:25,837][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:14:25,919][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:26,039][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:14:26,076][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:26,139][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:14:26,171][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:26,232][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:14:31,945][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:32,010][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-03-10 15:14:32,506][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:32,579][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:14:32,839][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:32,951][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:14:33,096][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:33,160][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:14:34,069][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:14:34,074][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:15:20,705][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:15:20,799][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:15:21,054][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:21,163][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:15:21,260][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:21,339][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:15:21,381][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:21,486][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:15:21,526][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:21,593][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:15:21,626][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:21,690][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:15:27,799][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:27,860][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Starting task run...
[2022-03-10 15:15:28,253][prefect.TaskRunner][INFO] - Task 'get_clusters_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:28,328][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:15:28,578][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:28,695][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:15:28,826][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:28,887][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:15:29,802][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:15:29,807][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:34:40,253][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:34:40,357][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:34:40,525][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:40,586][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:34:40,619][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:40,681][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:34:40,682][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:34:40,712][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:34:40,774][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:34:40,908][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:41,020][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:34:41,087][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:41,171][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:34:41,210][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:41,312][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:34:41,348][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:41,409][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:34:48,205][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:48,268][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:34:48,270][prefect.TaskRunner][ERROR] - Task 'get_model_with_predefined_clusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 84, in get_model_with_predefined_clusters
    model_args = model.args
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 357, in __getattr__
    self._format_and_raise(key=key, value=None, cause=e)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 741, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 351, in __getattr__
    return self._get_impl(key=key, default_value=_DEFAULT_MARKER_)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 438, in _get_impl
    node = self._get_node(key=key, throw_on_missing_key=True)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 465, in _get_node
    self._validate_get(key)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 166, in _validate_get
    self._format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 821, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
omegaconf.errors.ConfigAttributeError: Key 'args' is not in struct
    full_key: segment.args.args
    object_type=dict
[2022-03-10 15:34:48,311][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:34:48,384][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:34:48,417][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:34:48,480][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:34:48,511][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:34:48,573][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:34:48,605][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:34:48,708][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:34:48,738][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:34:48,801][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:34:48,832][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:34:48,837][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:35:44,875][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:35:44,980][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:35:45,230][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,338][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:35:45,420][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,502][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:35:45,544][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,646][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:35:45,684][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,748][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:35:45,781][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,844][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:35:45,878][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:45,943][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:35:45,944][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:35:45,976][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:35:46,058][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:35:46,099][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:46,164][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:35:46,196][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:35:46,258][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:35:46,290][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:35:46,353][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:35:46,385][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:35:46,449][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:35:52,835][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:35:52,941][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:35:52,974][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:35:53,037][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:35:53,039][prefect.TaskRunner][ERROR] - Task 'get_model_with_predefined_clusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 85, in get_model_with_predefined_clusters
    model_args["n_clusters"] = k
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 314, in __setitem__
    self._format_and_raise(key=key, value=value, cause=e)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/base.py", line 190, in _format_and_raise
    format_and_raise(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 821, in format_and_raise
    _raise(ex, cause)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/_utils.py", line 719, in _raise
    raise ex.with_traceback(sys.exc_info()[2])  # set end OC_CAUSE=1 for full backtrace
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 308, in __setitem__
    self.__set_impl(key=key, value=value)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/dictconfig.py", line 318, in __set_impl
    self._set_item_impl(key, value)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 581, in _set_item_impl
    self.__dict__["_content"][key] = wrap(key, value)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/basecontainer.py", line 556, in wrap
    return _maybe_wrap(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 1041, in _maybe_wrap
    return _node_wrap(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/omegaconf.py", line 1002, in _node_wrap
    node = AnyNode(value=value, key=key, parent=parent)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/nodes.py", line 116, in __init__
    super().__init__(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/nodes.py", line 27, in __init__
    self._set_value(value)  # lgtm [py/init-calls-subclass]
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/nodes.py", line 44, in _set_value
    self._val = self.validate_and_convert(value)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/nodes.py", line 57, in validate_and_convert
    return self._validate_and_convert_impl(value)
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/omegaconf/nodes.py", line 133, in _validate_and_convert_impl
    raise UnsupportedValueType(
omegaconf.errors.UnsupportedValueType: Value 'int64' is not a supported primitive type
    full_key: segment.args.n_clusters
    object_type=dict
[2022-03-10 15:35:53,079][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:35:53,084][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:36:37,256][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:36:37,353][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:36:37,513][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:37,578][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:36:37,612][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:37,677][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:36:37,678][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:36:37,710][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:36:37,776][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:36:37,777][prefect.TaskRunner][ERROR] - Task 'wandb_log': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 143, in wandb_log
    wandb.log_artifact(config.raw_data.path, name='raw_data', type='data')
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/wandb/sdk/lib/preinit.py", line 38, in preinit_wrapper
    raise wandb.Error("You must call wandb.init() before {}()".format(name))
wandb.errors.Error: You must call wandb.init() before wandb.log_artifact()
[2022-03-10 15:36:37,811][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Failed'
[2022-03-10 15:36:37,877][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:36:37,998][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:38,108][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:36:38,194][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:38,320][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:36:38,358][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:38,425][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:36:38,459][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:36:38,525][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:36:38,557][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:36:38,623][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:36:44,304][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:44,406][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:36:44,437][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:36:44,499][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:36:44,530][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:44,592][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:36:44,961][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:36:45,029][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:36:45,060][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:36:45,065][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:37:59,792][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:37:59,904][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:38:00,089][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:00,158][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:38:00,193][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:00,270][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:38:00,271][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:38:00,312][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:38:00,399][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:38:00,543][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:00,668][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:38:00,807][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:00,899][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:38:00,945][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:01,051][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:38:01,087][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:01,156][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:38:11,467][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:11,535][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:38:13,024][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:13,098][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:38:13,135][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:38:13,203][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:38:13,233][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:38:13,294][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:38:13,326][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:38:13,434][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:38:13,468][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:38:13,534][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:38:13,565][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:38:13,571][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:41:38,962][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:41:39,055][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:41:39,304][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:39,408][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:41:39,478][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:39,567][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:41:39,627][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:39,751][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:41:39,799][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:39,869][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:41:39,908][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:39,978][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:41:40,014][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:40,081][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:41:40,082][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:41:40,114][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:41:40,181][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:41:40,213][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:40,277][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:41:40,308][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:41:40,373][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:41:40,405][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:41:40,472][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:41:40,505][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:41:40,571][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:41:46,957][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:47,067][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:41:47,100][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:41:47,170][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:41:47,754][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:41:47,762][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:42:29,949][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:42:30,043][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:42:30,197][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:30,258][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:42:30,290][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:30,352][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:42:30,469][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:30,571][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:42:30,639][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:30,726][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:42:30,727][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:42:30,758][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:30,868][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:42:30,903][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:30,963][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:42:31,000][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:31,060][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:42:31,089][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:31,149][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:42:36,943][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:37,007][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:42:37,039][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:37,102][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:42:37,136][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:37,199][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:42:37,503][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:37,571][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:42:37,604][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:37,667][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:42:37,935][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:38,052][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:42:38,176][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:38,239][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:42:38,269][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:38,330][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:42:39,205][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:42:39,264][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:42:39,293][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:42:39,300][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:43:52,193][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:43:52,298][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:43:52,602][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:52,716][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:43:52,803][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:52,893][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:43:52,930][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:53,006][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:43:53,051][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:53,169][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:43:53,207][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:53,271][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:43:53,305][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:53,369][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:43:53,402][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:43:53,469][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:43:53,470][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:43:53,505][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:43:53,578][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:44:06,406][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:44:06,476][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:44:08,295][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:44:08,362][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:44:08,394][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:44:08,457][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:44:08,500][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:44:08,567][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:44:08,600][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:44:08,713][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:44:08,746][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:44:08,751][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:47:02,564][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:47:02,659][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:47:02,924][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,030][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:47:03,098][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,182][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:47:03,214][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,314][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:47:03,351][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,412][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:47:03,444][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,505][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:47:03,536][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,596][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:47:03,597][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:47:03,627][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:47:03,689][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:47:03,728][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:03,790][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:47:09,684][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:09,744][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:47:10,108][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:10,176][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:47:10,206][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:47:10,265][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:47:10,295][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:10,354][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:47:10,618][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:10,730][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:47:10,854][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:10,914][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:47:11,793][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:47:11,799][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:48:53,644][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:48:53,738][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:48:53,739][prefect.TaskRunner][ERROR] - Task 'wandb_log': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 144, in wandb_log
    wandb.log_artifact(config.raw_data.path, name='raw_data', type='data')
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/wandb/sdk/lib/preinit.py", line 38, in preinit_wrapper
    raise wandb.Error("You must call wandb.init() before {}()".format(name))
wandb.errors.Error: You must call wandb.init() before wandb.log_artifact()
[2022-03-10 15:48:53,899][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Failed'
[2022-03-10 15:48:53,960][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:48:54,080][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,150][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:48:54,185][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,292][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:48:54,367][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,452][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:48:54,453][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:48:54,483][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:48:54,584][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:48:54,624][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,684][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:48:54,716][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,777][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:48:54,808][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:48:54,868][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:48:54,899][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:48:54,958][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:49:00,875][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:00,936][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:49:01,278][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:01,356][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:49:01,387][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:01,447][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:49:01,517][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:01,634][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:49:01,755][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:01,816][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:49:02,677][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:02,682][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:49:44,714][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:49:44,808][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:49:45,064][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,168][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:49:45,226][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,314][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:49:45,350][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,412][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:49:45,442][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,504][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:49:45,544][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,643][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:49:45,677][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:45,737][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:49:53,619][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:53,680][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:49:53,681][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:49:53,712][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:49:53,772][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:49:53,804][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:53,868][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:49:54,255][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:54,338][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:49:54,370][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:49:54,432][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:49:54,464][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:54,525][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:49:54,596][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:54,711][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:49:54,834][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:54,896][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:49:55,812][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:49:55,817][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:50:17,234][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:50:17,328][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:50:17,575][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:17,683][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:50:17,750][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:17,837][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:50:17,871][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:17,938][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:50:17,974][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:18,042][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:50:18,086][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:18,191][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:50:18,232][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:18,298][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:50:18,299][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 15:50:18,335][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:50:18,403][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:50:24,958][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:25,020][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:50:25,382][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:25,465][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:50:25,499][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:25,565][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:50:25,596][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:50:25,657][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:50:25,688][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:25,749][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:50:25,838][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:25,968][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:50:26,089][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:26,151][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:50:27,023][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:27,028][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 15:50:52,154][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:50:52,244][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:50:52,497][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:52,598][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:50:52,667][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:52,779][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:50:52,817][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:52,882][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:50:52,916][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:52,981][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:50:53,023][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:50:53,088][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:50:53,089][prefect.TaskRunner][ERROR] - Task 'check_has_nclusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 54, in check_has_nclusters
    return 'n_clusters' in config.segment.args
TypeError: argument of type 'NoneType' is not iterable
[2022-03-10 15:50:53,131][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:50:53,200][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:50:53,238][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,305][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:50:53,357][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,436][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:50:53,468][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,531][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:50:53,563][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,629][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:50:53,660][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,722][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:50:53,753][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,814][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:50:53,845][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:53,948][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:50:53,978][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:54,038][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:50:54,068][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:50:54,073][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:52:10,268][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:52:10,360][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:52:10,615][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:10,720][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:52:10,787][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:10,874][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:52:10,915][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:11,017][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:52:11,055][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:11,118][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:52:11,119][prefect.TaskRunner][ERROR] - Task 'check_has_nclusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 54, in check_has_nclusters
    return 'n_clusters' in config.segment.args
TypeError: argument of type 'NoneType' is not iterable
[2022-03-10 15:52:11,155][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:52:11,225][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:52:11,257][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,322][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:52:11,357][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:11,420][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:52:11,453][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,517][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:52:11,549][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,613][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:52:11,645][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,711][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:52:11,742][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,808][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:52:11,838][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:11,905][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:52:11,934][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:12,037][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:52:12,071][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:12,132][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:52:12,165][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:12,170][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:52:37,387][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:52:37,482][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:52:37,483][prefect.TaskRunner][ERROR] - Task 'check_has_nclusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 54, in check_has_nclusters
    return 'n_clusters' in config.segment.args
TypeError: argument of type 'NoneType' is not iterable
[2022-03-10 15:52:37,643][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:52:37,705][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:52:37,738][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:37,802][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:52:37,918][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:38,026][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:52:38,098][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:38,178][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:52:38,208][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:38,274][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:52:38,312][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:38,412][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:52:38,447][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:38,507][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:52:38,538][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:38,597][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:52:38,628][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:52:38,687][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:52:38,718][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:38,778][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:52:38,808][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:38,878][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:52:38,911][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:38,973][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:52:39,003][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:39,106][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:52:39,139][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:39,203][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:52:39,235][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:52:39,241][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:53:46,411][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:53:46,510][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:53:46,673][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:46,734][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:53:46,734][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "False" did not match "True"')
[2022-03-10 15:53:46,765][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:53:46,825][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:53:46,856][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:46,917][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:53:47,030][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:47,134][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:53:47,202][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:47,284][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:53:47,323][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:47,422][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:53:47,457][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:47,518][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:53:47,519][prefect.TaskRunner][ERROR] - Task 'get_model_without_predefined_clusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 101, in get_model_without_predefined_clusters
    model = eval(model.algorithm)(**model.args)
TypeError: type object argument after ** must be a mapping, not NoneType
[2022-03-10 15:53:47,552][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:53:47,613][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:53:47,647][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:53:47,719][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:53:47,752][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:53:47,813][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:53:47,843][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:53:47,904][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:53:47,936][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:53:47,997][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:53:48,028][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:53:48,131][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:53:48,163][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:53:48,234][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:53:48,269][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:53:48,275][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:54:56,688][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:54:56,777][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:54:57,028][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,135][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:54:57,209][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,289][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:54:57,327][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,426][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:54:57,461][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,520][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:54:57,550][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,622][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:54:57,653][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,713][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:54:57,744][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:54:57,805][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:54:57,806][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "False" did not match "True"')
[2022-03-10 15:54:57,837][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:54:57,903][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:54:57,934][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:54:57,996][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:54:57,998][prefect.TaskRunner][ERROR] - Task 'get_model_without_predefined_clusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 103, in get_model_without_predefined_clusters
    model = eval(model.algorithm)(**model.args)
TypeError: type object argument after ** must be a mapping, not NoneType
[2022-03-10 15:54:58,036][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:54:58,100][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:54:58,133][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:54:58,202][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:54:58,241][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:54:58,302][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:54:58,333][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:54:58,435][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:54:58,465][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:54:58,527][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:54:58,562][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:54:58,568][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:55:33,533][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:55:33,622][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:55:33,778][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:33,837][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:55:33,837][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "False" did not match "True"')
[2022-03-10 15:55:33,867][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:55:33,925][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:55:33,955][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,017][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:55:34,146][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,247][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:55:34,315][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,399][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:55:34,437][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,538][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:55:34,584][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,649][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:55:34,650][prefect.TaskRunner][ERROR] - Task 'get_model_without_predefined_clusters': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 103, in get_model_without_predefined_clusters
    model = eval(model.algorithm)(**model_ags)
UnboundLocalError: local variable 'model_ags' referenced before assignment
[2022-03-10 15:55:34,683][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Failed'
[2022-03-10 15:55:34,743][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:55:34,775][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:55:34,838][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:55:34,869][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:55:34,928][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:55:34,958][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:55:35,019][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:55:35,050][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:55:35,110][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:55:35,143][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:55:35,241][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:55:35,272][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:55:35,330][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:55:35,360][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:55:35,366][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 15:56:28,683][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 15:56:28,775][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 15:56:28,926][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:28,985][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 15:56:28,985][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "False" did not match "True"')
[2022-03-10 15:56:29,016][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:56:29,077][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 15:56:29,109][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:29,170][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 15:56:29,285][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:29,387][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 15:56:29,454][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:29,542][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 15:56:29,582][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:29,687][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 15:56:29,723][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:29,784][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Starting task run...
[2022-03-10 15:56:34,904][prefect.TaskRunner][INFO] - Task 'get_model_without_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:34,963][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 15:56:34,995][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:35,056][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 15:56:35,087][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:56:35,146][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Starting task run...
[2022-03-10 15:56:35,177][prefect.TaskRunner][INFO] - Task 'get_model_with_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 15:56:35,240][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 15:56:35,272][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 15:56:35,335][prefect.TaskRunner][INFO] - Task 'predict': Starting task run...
[2022-03-10 15:56:35,336][prefect.TaskRunner][ERROR] - Task 'predict': Exception encountered during task execution!
Traceback (most recent call last):
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/engine/task_runner.py", line 876, in get_task_run_state
    value = prefect.utilities.executors.run_task_with_timeout(
  File "/home/khuyen/customer_segmentation/.venv/lib/python3.8/site-packages/prefect/utilities/executors.py", line 467, in run_task_with_timeout
    return task.run(*args, **kwargs)  # type: ignore
  File "src/segment.py", line 110, in predict
    return model.predict(pca_df)
AttributeError: 'OPTICS' object has no attribute 'predict'
[2022-03-10 15:56:35,369][prefect.TaskRunner][INFO] - Task 'predict': Finished task run for task with final state: 'Failed'
[2022-03-10 15:56:35,468][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 15:56:35,499][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:56:35,559][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 15:56:35,588][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'TriggerFailed'
[2022-03-10 15:56:35,593][prefect.FlowRunner][INFO] - Flow run FAILED: some reference tasks failed.
[2022-03-10 16:00:19,139][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 16:00:19,232][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 16:00:19,478][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:19,580][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 16:00:19,646][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:19,762][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 16:00:19,800][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:19,862][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 16:00:19,900][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:19,960][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 16:00:19,990][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:20,050][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 16:00:20,081][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:20,141][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 16:00:20,171][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:20,238][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 16:00:20,239][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "False" did not match "True"')
[2022-03-10 16:00:20,274][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:00:20,343][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Starting task run...
[2022-03-10 16:00:25,442][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:25,509][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 16:00:25,542][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:00:25,604][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Starting task run...
[2022-03-10 16:00:25,636][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:00:25,697][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 16:00:25,729][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:25,829][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 16:00:25,951][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:26,012][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 16:00:27,806][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:00:27,811][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 16:14:54,757][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 16:14:54,849][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 16:14:55,098][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,159][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 16:14:55,190][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,291][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 16:14:55,358][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,440][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 16:14:55,480][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,579][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 16:14:55,614][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,699][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 16:14:55,730][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,794][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 16:14:55,795][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 16:14:55,827][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:14:55,893][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 16:14:55,926][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 16:14:55,992][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 16:15:01,688][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:01,756][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Starting task run...
[2022-03-10 16:15:02,102][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:02,172][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Starting task run...
[2022-03-10 16:15:02,204][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:15:02,266][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 16:15:02,297][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:02,360][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 16:15:03,253][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:03,354][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 16:15:03,473][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:03,478][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
[2022-03-10 16:15:42,664][prefect.FlowRunner][INFO] - Beginning Flow run for 'segmentation'
[2022-03-10 16:15:42,756][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Starting task run...
[2022-03-10 16:15:43,009][prefect.TaskRunner][INFO] - Task 'initialize_wandb': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,072][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Starting task run...
[2022-03-10 16:15:43,104][prefect.TaskRunner][INFO] - Task 'check_has_nclusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,207][prefect.TaskRunner][INFO] - Task 'get_pca_model': Starting task run...
[2022-03-10 16:15:43,268][prefect.TaskRunner][INFO] - Task 'get_pca_model': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,355][prefect.TaskRunner][INFO] - Task 'case(True)': Starting task run...
[2022-03-10 16:15:43,391][prefect.TaskRunner][INFO] - Task 'case(True)': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,458][prefect.TaskRunner][INFO] - Task 'wandb_log': Starting task run...
[2022-03-10 16:15:43,499][prefect.TaskRunner][INFO] - Task 'wandb_log': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,601][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Starting task run...
[2022-03-10 16:15:43,640][prefect.TaskRunner][INFO] - Task 'reduce_dimension': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:43,709][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Starting task run...
[2022-03-10 16:15:49,388][prefect.TaskRunner][INFO] - Task 'get_best_k_cluster': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:49,449][prefect.TaskRunner][INFO] - Task 'case(False)': Starting task run...
[2022-03-10 16:15:49,450][prefect.TaskRunner][INFO] - SKIP signal raised: SKIP('Provided value "True" did not match "False"')
[2022-03-10 16:15:49,480][prefect.TaskRunner][INFO] - Task 'case(False)': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:15:49,538][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Starting task run...
[2022-03-10 16:15:49,568][prefect.TaskRunner][INFO] - Task 'get_3d_projection': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:49,630][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Starting task run...
[2022-03-10 16:15:49,993][prefect.TaskRunner][INFO] - Task 'predict_with_predefined_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:50,057][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Starting task run...
[2022-03-10 16:15:50,087][prefect.TaskRunner][INFO] - Task 'predict_without_predefined_clusters': Finished task run for task with final state: 'Skipped'
[2022-03-10 16:15:50,145][prefect.TaskRunner][INFO] - Task 'Merge': Starting task run...
[2022-03-10 16:15:50,175][prefect.TaskRunner][INFO] - Task 'Merge': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:50,234][prefect.TaskRunner][INFO] - Task 'plot_clusters': Starting task run...
[2022-03-10 16:15:51,099][prefect.TaskRunner][INFO] - Task 'plot_clusters': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:51,197][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Starting task run...
[2022-03-10 16:15:51,314][prefect.TaskRunner][INFO] - Task 'insert_clusters_to_df': Finished task run for task with final state: 'Success'
[2022-03-10 16:15:51,318][prefect.FlowRunner][INFO] - Flow run SUCCESS: all reference tasks succeeded
